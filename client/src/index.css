@tailwind base;
@tailwind components;
@tailwind utilities;

/* Safe area support for mobile devices */
:root {
  --safe-area-inset-top: env(safe-area-inset-top);
  --safe-area-inset-right: env(safe-area-inset-right);
  --safe-area-inset-bottom: env(safe-area-inset-bottom);
  --safe-area-inset-left: env(safe-area-inset-left);
}

/* Mobile viewport handling */
@supports (height: 100dvh) {
  :root {
    --viewport-height: 100dvh;
  }
}

@supports not (height: 100dvh) {
  :root {
    --viewport-height: 100vh;
  }
}

/* Chat container mobile fixes */
@media (max-width: 768px) {
  .mobile-chat-container {
    height: calc(60vh - max(20px, env(safe-area-inset-bottom))) !important;
    max-height: calc(60vh - max(20px, env(safe-area-inset-bottom))) !important;
    min-height: 300px !important;
  }
  
  .mobile-conversation-area {
    height: 150px !important;
    max-height: 150px !important;
  }
  
  /* Enhanced touch scrolling for mobile */
  .mobile-chat-container {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    scroll-behavior: smooth;
  }
  
  /* Better message bubble sizing on mobile */
  .mobile-message-bubble {
    max-width: 85% !important;
    font-size: 14px !important;
    line-height: 1.4 !important;
    padding: 8px 12px !important;
  }
  
  /* Optimized input area for mobile keyboards */
  .mobile-input-container {
    padding-bottom: max(12px, env(safe-area-inset-bottom)) !important;
    position: sticky !important;
    bottom: 0 !important;
    background: rgba(15, 23, 42, 0.95) !important;
    backdrop-filter: blur(20px) !important;
  }
}

/* Responsive Touch Enhancements */
@layer utilities {
  .touch-manipulation {
    touch-action: manipulation;
  }
  
  .touch-pan-x {
    touch-action: pan-x;
  }
  
  .touch-pan-y {
    touch-action: pan-y;
  }
  
  .touch-pinch-zoom {
    touch-action: pinch-zoom;
  }
  
  /* Mobile-optimized scrolling */
  .smooth-scroll {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
  }
  
  /* Prevent text selection on interactive elements */
  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  /* Better focus visibility for accessibility */
  .focus-ring {
    @apply focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-opacity-75;
  }
  
  /* Mobile-friendly button sizing */
  .btn-touch {
    min-height: 44px;
    min-width: 44px;
  }
  
  @media (max-width: 640px) {
    .btn-touch {
      min-height: 48px;
      min-width: 48px;
    }
    
    /* Mobile zone optimizations */
    .mobile-zone {
      padding: 8px 4px !important;
    }
    
    .mobile-zone-title {
      font-size: 12px !important;
      line-height: 1.2 !important;
      margin-bottom: 2px !important;
    }
    
    .mobile-zone-desc {
      display: none !important;
    }
    
    /* Mobile location nodes */
    .mobile-location-node {
      width: 36px !important;
      height: 36px !important;
      min-width: 36px !important;
      min-height: 36px !important;
    }
  }
}

/* Custom Scrollbar for Character Command */
.character-scrollbar::-webkit-scrollbar {
  width: 8px;
}

.character-scrollbar::-webkit-scrollbar-track {
  background: rgba(30, 41, 59, 0.3);
  border-radius: 8px;
  border: 1px solid rgba(148, 163, 184, 0.1);
}

.character-scrollbar::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, rgba(147, 51, 234, 0.8) 0%, rgba(251, 191, 36, 0.8) 100%);
  border-radius: 8px;
  border: 1px solid rgba(147, 51, 234, 0.3);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.character-scrollbar::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, rgba(147, 51, 234, 1) 0%, rgba(251, 191, 36, 1) 100%);
  box-shadow: 0 4px 8px rgba(147, 51, 234, 0.4);
}

.character-scrollbar::-webkit-scrollbar-corner {
  background: rgba(30, 41, 59, 0.3);
}

/* Custom Scrollbar for Skill Constellation Panel */
.constellation-scrollbar::-webkit-scrollbar {
  width: 6px;
}

.constellation-scrollbar::-webkit-scrollbar-track {
  background: rgba(51, 65, 85, 0.2);
  border-radius: 6px;
}

.constellation-scrollbar::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, rgba(251, 191, 36, 0.6) 0%, rgba(147, 51, 234, 0.6) 100%);
  border-radius: 6px;
  border: 1px solid rgba(251, 191, 36, 0.2);
}

.constellation-scrollbar::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, rgba(251, 191, 36, 0.8) 0%, rgba(147, 51, 234, 0.8) 100%);
}

/* Epic Skill Visual Effects */
.bg-gradient-radial {
  background: radial-gradient(circle, var(--tw-gradient-stops));
}

/* Screen shake animations */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px) translateY(-1px); }
  75% { transform: translateX(2px) translateY(1px); }
}

.animate-shake {
  animation: shake 0.3s ease-in-out;
}

/* Camera shake for intense effects */
@keyframes camera-shake {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  25% { transform: translate(-3px, -2px) rotate(-0.5deg); }
  50% { transform: translate(3px, -1px) rotate(0.5deg); }
  75% { transform: translate(-2px, 2px) rotate(-0.3deg); }
}

.animate-camera-shake {
  animation: camera-shake 0.5s ease-in-out;
}

/* Custom Scrollbar for Daily Life Hub */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgba(147, 51, 234, 0.6) rgba(255, 255, 255, 0.1);
}

.custom-scrollbar::-webkit-scrollbar {
  width: 8px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
  backdrop-filter: blur(10px);
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: linear-gradient(
    180deg,
    rgba(147, 51, 234, 0.8) 0%,
    rgba(236, 72, 153, 0.8) 50%,
    rgba(147, 51, 234, 0.8) 100%
  );
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 2px 8px rgba(147, 51, 234, 0.3);
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(
    180deg,
    rgba(147, 51, 234, 1) 0%,
    rgba(236, 72, 153, 1) 50%,
    rgba(147, 51, 234, 1) 100%
  );
  box-shadow: 0 4px 12px rgba(147, 51, 234, 0.5);
}

.custom-scrollbar::-webkit-scrollbar-thumb:active {
  background: linear-gradient(
    180deg,
    rgba(139, 92, 246, 1) 0%,
    rgba(219, 39, 119, 1) 50%,
    rgba(139, 92, 246, 1) 100%
  );
}

/* Liquid Glassmorphism Design System */
@layer utilities {
  .liquid-glass {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(40px) saturate(200%) brightness(115%) hue-rotate(2deg);
    border: 0.8px solid rgba(255, 255, 255, 0.25);
    border-radius: 16px;
    box-shadow: 
      0 8px 32px rgba(0, 0, 0, 0.2),
      inset 0 2px 0 rgba(255, 255, 255, 0.4),
      inset 0 -2px 0 rgba(255, 255, 255, 0.1),
      0 0 0 1px rgba(255, 255, 255, 0.05);
    position: relative;
    overflow: hidden;
  }

  .liquid-glass::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.1) 0%,
      rgba(255, 255, 255, 0.05) 50%,
      rgba(255, 255, 255, 0.02) 100%
    );
    border-radius: inherit;
    pointer-events: none;
    opacity: 0.8;
  }

  .liquid-glass-shimmer {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(20px) saturate(180%) hue-rotate(10deg);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 16px;
    position: relative;
    overflow: hidden;
    animation: liquid-shimmer 3s ease-in-out infinite;
  }

  .liquid-glass-shimmer::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(
      45deg,
      transparent 30%,
      rgba(147, 51, 234, 0.3) 50%,
      transparent 70%
    );
    border-radius: inherit;
    animation: shimmer-flow 2s linear infinite;
    z-index: -1;
  }

  .liquid-glass-flowing {
    background: rgba(255, 255, 255, 0.06);
    backdrop-filter: blur(25px) saturate(200%) contrast(120%);
    border: 1px solid;
    border-image: linear-gradient(45deg, 
      rgba(147, 51, 234, 0.4), 
      rgba(59, 130, 246, 0.4), 
      rgba(147, 51, 234, 0.4)
    ) 1;
    border-radius: 20px;
    position: relative;
    overflow: hidden;
    filter: drop-shadow(0 8px 24px rgba(147, 51, 234, 0.2));
  }

  .liquid-glass-flowing::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(255, 255, 255, 0.1) 50%,
      transparent 100%
    );
    animation: liquid-flow 4s ease-in-out infinite;
  }

  .liquid-glass-modal {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(40px) saturate(180%) brightness(120%);
    border: 0.5px solid rgba(255, 255, 255, 0.15);
    border-radius: 18px;
    box-shadow: 
      0 8px 32px rgba(0, 0, 0, 0.25),
      inset 0 1px 0 rgba(255, 255, 255, 0.25),
      inset 0 -1px 0 rgba(255, 255, 255, 0.08);
    position: relative;
    overflow: hidden;
  }

  .liquid-glass-modal::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(147, 51, 234, 0.6) 50%,
      transparent 100%
    );
    animation: top-glow 3s ease-in-out infinite alternate;
  }

  .liquid-glass-button {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px) saturate(160%) brightness(110%);
    border: 0.5px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    box-shadow: 
      0 2px 12px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .liquid-glass-nav-bar {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(30px) saturate(180%) brightness(115%);
    border: 0.5px solid rgba(255, 255, 255, 0.25);
    border-radius: 16px;
    box-shadow: 
      0 4px 24px rgba(0, 0, 0, 0.12),
      inset 0 1px 0 rgba(255, 255, 255, 0.3),
      inset 0 -1px 0 rgba(255, 255, 255, 0.1);
    position: relative;
    overflow: hidden;
  }

  .liquid-glass-nav-item {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(20px) saturate(160%);
    border-radius: 12px;
    transition: all 0.2s ease;
    position: relative;
  }

  .liquid-glass-nav-item:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateY(-1px);
  }

  .liquid-glass-nav-item.active {
    background: rgba(255, 255, 255, 0.2);
    box-shadow: 
      0 2px 8px rgba(0, 0, 0, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.3);
  }

  .liquid-glass-button:hover {
    background: linear-gradient(
      135deg,
      rgba(147, 51, 234, 0.3) 0%,
      rgba(147, 51, 234, 0.15) 100%
    );
    border-color: rgba(147, 51, 234, 0.5);
    box-shadow: 
      0 8px 32px rgba(147, 51, 234, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.15);
    transform: translateY(-2px);
  }

  .liquid-glass-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    box-shadow: 
      0 8px 32px rgba(0, 0, 0, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.08);
    position: relative;
    overflow: hidden;
  }

  .liquid-glass-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      circle at 30% 20%,
      rgba(147, 51, 234, 0.1) 0%,
      transparent 70%
    );
    pointer-events: none;
  }
}

/* Mobile Chat Overlay Fixes */
.mobile-chat-overlay {
  /* Use CSS custom properties for dynamic viewport height */
  height: calc(var(--vh, 1vh) * 100);
  min-height: -webkit-fill-available;
  min-height: fill-available;
  /* Prevent zoom on mobile */
  touch-action: manipulation;
}

/* Mobile input container adjustments */
.mobile-input-container {
  /* Ensure input stays visible above mobile keyboard */
  position: sticky;
  bottom: 0;
  z-index: 1000;
  /* Prevent input zoom on iOS */
  transform: translateZ(0);
}

/* Chat messages container mobile optimization */
.mobile-chat-messages {
  /* Adjust height to account for mobile keyboards */
  max-height: calc(var(--vh, 1vh) * 65);
  min-height: 300px;
  /* Ensure smooth scrolling on mobile */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  /* Better mobile scrolling performance */
  transform: translateZ(0);
}

/* Mobile-specific viewport handling */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari specific fixes */
  .mobile-chat-overlay {
    height: -webkit-fill-available;
  }
  
  .mobile-chat-messages {
    max-height: calc(100vh - 180px);
    min-height: 250px;
  }
}

/* Mobile keyboard detection via viewport changes */
@media screen and (max-height: 500px) and (max-width: 768px) {
  /* When keyboard is likely visible (short viewport) */
  .mobile-chat-messages {
    max-height: calc(100vh - 100px);
    min-height: 150px;
    padding-bottom: 10px;
  }
  
  .mobile-input-container {
    padding: 6px 12px;
  }
}

/* Enhanced mobile responsiveness */
@media (max-width: 640px) {
  .mobile-chat-overlay {
    padding: 4px;
  }
  
  .mobile-chat-messages {
    padding: 8px 12px;
  }
  
  /* Optimize message bubbles for mobile */
  .mobile-chat-messages > div {
    max-width: 90%;
  }
  
  /* Prevent text input zoom on iOS */
  input[type="text"], 
  textarea {
    font-size: 16px !important;
    transform: translateZ(0);
  }
}

/* Cinematic Message Formatting */
.cinematic-dialogue {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: 400;
  line-height: 1.6;
  letter-spacing: 0.01em;
  color: #ffffff;
  text-shadow: 0 1px 3px rgba(0,0,0,0.8);
  margin-bottom: 1rem;
  padding: 0.5rem 0;
}

.cinematic-action {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: 300;
  font-style: italic;
  line-height: 1.6;
  letter-spacing: 0.005em;
  color: #fbbf24;
  opacity: 0.9;
  text-shadow: 0 1px 2px rgba(251,191,36,0.3);
  margin-bottom: 1.25rem;
  padding: 0.25rem 0;
}

.cinematic-thought {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: 300;
  font-style: italic;
  line-height: 1.6;
  letter-spacing: 0.005em;
  color: #94a3b8;
  opacity: 0.75;
  text-shadow: 0 1px 2px rgba(0,0,0,0.6);
  margin-bottom: 1rem;
  padding: 0.5rem 0 0.5rem 1rem;
  border-left: 2px solid rgba(148,163,184,0.3);
}

.cinematic-narrative {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: 300;
  line-height: 1.6;
  letter-spacing: 0.005em;
  color: #cbd5e1;
  opacity: 0.8;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  margin-bottom: 0.75rem;
  padding: 0.25rem 0;
}

/* Enhanced message bubble spacing */
.message-block {
  margin-bottom: 1.5rem;
}

.message-block:last-child {
  margin-bottom: 0;
}

/* Improved readability on mobile */
@media (max-width: 640px) {
  .cinematic-dialogue {
    font-size: 0.95rem;
    line-height: 1.5;
    margin-bottom: 0.875rem;
  }
  
  .cinematic-action {
    font-size: 0.875rem;
    line-height: 1.5;
    margin-bottom: 1rem;
  }
  
  .cinematic-thought {
    font-size: 0.875rem;
    line-height: 1.5;
    margin-bottom: 0.875rem;
    padding-left: 0.75rem;
  }
  
  .cinematic-narrative {
    font-size: 0.875rem;
    line-height: 1.5;
    margin-bottom: 0.625rem;
  }
}

@keyframes liquid-shimmer {
  0%, 100% { 
    filter: hue-rotate(0deg) saturate(180%); 
  }
  50% { 
    filter: hue-rotate(10deg) saturate(220%); 
  }
}

@keyframes shimmer-flow {
  0% { 
    transform: translateX(-100%) skewX(-15deg); 
  }
  100% { 
    transform: translateX(200%) skewX(-15deg); 
  }
}

@keyframes liquid-flow {
  0% { 
    left: -100%; 
  }
  50% { 
    left: 100%; 
  }
  100% { 
    left: -100%; 
  }
}

@keyframes top-glow {
  0% { 
    opacity: 0.3; 
  }
  100% { 
    opacity: 0.8; 
  }
}

@keyframes wavy-distortion {
  0%, 100% {
    clip-path: polygon(0% 0%, 100% 0%, 100% 98%, 0% 100%);
    filter: blur(0px);
  }
  25% {
    clip-path: polygon(0% 2%, 100% 0%, 100% 100%, 0% 98%);
    filter: blur(0.3px);
  }
  50% {
    clip-path: polygon(0% 0%, 100% 2%, 100% 98%, 0% 100%);
    filter: blur(0.1px);
  }
  75% {
    clip-path: polygon(0% 1%, 100% 0%, 100% 99%, 0% 97%);
    filter: blur(0.2px);
  }
}

.liquid-glass-enhanced {
  background: rgba(255, 255, 255, 0.06);
  backdrop-filter: blur(50px) saturate(220%) brightness(120%) hue-rotate(3deg);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 20px;
  box-shadow: 
    0 12px 40px rgba(0, 0, 0, 0.25),
    inset 0 3px 0 rgba(255, 255, 255, 0.5),
    inset 0 -3px 0 rgba(255, 255, 255, 0.1),
    0 0 0 2px rgba(255, 255, 255, 0.08);
  position: relative;
  overflow: hidden;
  animation: wavy-distortion 8s ease-in-out infinite;
}

@layer base {
  :root {
    --background: 210 11% 98%; /* #F5F7FA */
    --foreground: 210 11% 15%; /* #1E293B */
    --card: 210 11% 100%; /* #FFFFFF */
    --card-foreground: 210 11% 15%; /* #1E293B */
    --popover: 210 11% 100%; /* #FFFFFF */
    --popover-foreground: 210 11% 15%; /* #1E293B */
    --primary: 262 100% 50%; /* #8B5CF6 */
    --primary-foreground: 210 20% 98%; /* #F8FAFC */
    --secondary: 210 11% 96%; /* #F1F5F9 */
    --secondary-foreground: 210 11% 15%; /* #1E293B */
    --muted: 210 11% 96%; /* #F1F5F9 */
    --muted-foreground: 210 11% 45%; /* #64748B */
    --accent: 210 11% 96%; /* #F1F5F9 */
    --accent-foreground: 210 11% 15%; /* #1E293B */
    --destructive: 0 84% 60%; /* #EF4444 */
    --destructive-foreground: 210 20% 98%; /* #F8FAFC */
    --border: 210 11% 91%; /* #E2E8F0 */
    --input: 210 11% 91%; /* #E2E8F0 */
    --ring: 262 100% 50%; /* #8B5CF6 */
    --radius: 0.5rem;
  }

  .dark {
    --background: 220 13% 6%; /* #0F172A */
    --foreground: 210 20% 98%; /* #F8FAFC */
    --card: 220 13% 9%; /* #1E293B */
    --card-foreground: 210 20% 98%; /* #F8FAFC */
    --popover: 220 13% 9%; /* #1E293B */
    --popover-foreground: 210 20% 98%; /* #F8FAFC */
    --primary: 262 100% 70%; /* #A855F7 */
    --primary-foreground: 220 13% 6%; /* #0F172A */
    --secondary: 220 13% 15%; /* #374151 */
    --secondary-foreground: 210 20% 98%; /* #F8FAFC */
    --muted: 220 13% 15%; /* #374151 */
    --muted-foreground: 210 11% 71%; /* #94A3B8 */
    --accent: 220 13% 15%; /* #374151 */
    --accent-foreground: 210 20% 98%; /* #F8FAFC */
    --destructive: 0 63% 31%; /* #7F1D1D */
    --destructive-foreground: 210 20% 98%; /* #F8FAFC */
    --border: 220 13% 20%; /* #475569 */
    --input: 220 13% 20%; /* #475569 */
    --ring: 262 100% 70%; /* #A855F7 */
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
}

/* Custom Solo Leveling Styles */
.glass-panel {
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(16px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.floating-stat {
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 9999px;
}

.choice-button {
  background: linear-gradient(90deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
  border: 1px solid rgba(139, 92, 246, 0.3);
  backdrop-filter: blur(8px);
  transition: all 0.3s ease;
}

.choice-button:hover {
  background: linear-gradient(90deg, rgba(139, 92, 246, 0.4) 0%, rgba(59, 130, 246, 0.4) 100%);
  border-color: rgba(139, 92, 246, 0.5);
  transform: translateY(-2px);
}

.dynamic-bg {
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  filter: brightness(0.7) contrast(1.1);
}

.story-overlay {
  background: linear-gradient(to bottom, rgba(147, 51, 234, 0.3) 0%, transparent 50%, rgba(0, 0, 0, 0.6) 100%);
}

.animate-float {
  animation: float 6s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

.glow-effect {
  box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
}

.text-shadow {
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

/* Auto-fading scrollbars */
::-webkit-scrollbar {
  width: 8px;
  opacity: 0;
  transition: opacity 0.3s ease;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: rgba(147, 51, 234, 0.4);
  border-radius: 4px;
  transition: background 0.3s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(147, 51, 234, 0.7);
}

/* Show scrollbar on hover or scroll */
*:hover::-webkit-scrollbar,
*:focus::-webkit-scrollbar,
.scrolling::-webkit-scrollbar {
  opacity: 1;
}

/* Chat container specific scrollbar styling */
.chat-container::-webkit-scrollbar {
  width: 6px;
}

.chat-container::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 3px;
}

/* Solo Leveling Game Animations */
.screen.shake {
  animation: screenShake 0.4s ease-in-out;
}

@keyframes screenShake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-5px); }
  40%, 80% { transform: translateX(5px); }
}

/* Energy System Animations */
.energy-bar.energy-restored {
  animation: energyRestore 1s ease-out;
  box-shadow: 0 0 20px rgba(255, 235, 59, 0.8);
}

.energy-bar.full-rest {
  animation: fullRestRestore 2s ease-out;
  box-shadow: 0 0 25px rgba(76, 175, 80, 0.9);
}

@keyframes energyRestore {
  0% { 
    transform: scale(1);
    box-shadow: 0 0 5px rgba(255, 235, 59, 0.3);
  }
  50% { 
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(255, 235, 59, 0.8);
  }
  100% { 
    transform: scale(1);
    box-shadow: 0 0 10px rgba(255, 235, 59, 0.5);
  }
}

@keyframes fullRestRestore {
  0% { 
    transform: scale(1);
    box-shadow: 0 0 5px rgba(76, 175, 80, 0.3);
  }
  25% { 
    transform: scale(1.1);
    box-shadow: 0 0 25px rgba(76, 175, 80, 0.9);
  }
  50% { 
    transform: scale(1.05);
    box-shadow: 0 0 30px rgba(76, 175, 80, 1);
  }
  75% { 
    transform: scale(1.02);
    box-shadow: 0 0 20px rgba(76, 175, 80, 0.7);
  }
  100% { 
    transform: scale(1);
    box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
  }
}

/* Ken Burns cinematic effect for background images */
.ken-burns-effect {
  animation: kenBurns 30s ease-in-out infinite alternate;
  transform-origin: center center;
}

@keyframes kenBurns {
  0% {
    transform: scale(1.0) translate(0, 0);
  }
  25% {
    transform: scale(1.1) translate(-2%, -1%);
  }
  50% {
    transform: scale(1.05) translate(1%, -2%);
  }
  75% {
    transform: scale(1.08) translate(-1%, 1%);
  }
  100% {
    transform: scale(1.03) translate(1%, 0);
  }
}

/* Minimal Glassmorphism UI effects - 80% reduced opacity */
.glassmorphism {
  background: rgba(255, 255, 255, 0.016);
  backdrop-filter: blur(2px) saturate(110%);
  border: 1px solid rgba(255, 255, 255, 0.03);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
}

.glassmorphism-dark {
  background: rgba(0, 0, 0, 0.04);
  backdrop-filter: blur(2px) saturate(110%);
  border: 1px solid rgba(255, 255, 255, 0.016);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

/* Choice Button Glassmorphism - 80% reduced */
.glassmorphism-choice {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.03), rgba(147, 51, 234, 0.03));
  backdrop-filter: blur(3px) saturate(120%);
  border: 1px solid rgba(255, 255, 255, 0.04);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.02), inset 0 1px 0 rgba(255, 255, 255, 0.04);
}

.glassmorphism-choice-hover {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(147, 51, 234, 0.05));
  backdrop-filter: blur(4px) saturate(130%);
  border: 1px solid rgba(255, 255, 255, 0.06);
  box-shadow: 0 3px 12px rgba(59, 130, 246, 0.04), inset 0 1px 0 rgba(255, 255, 255, 0.06);
  transform: translateY(-1px);
}

/* Choice carousel animations */
.choice-carousel {
  transition: transform 0.3s ease-in-out;
}

.choice-carousel.sliding {
  transform: translateX(-100%);
}

/* Affection meter animation */
.affection-heart {
  transition: all 0.3s ease;
}

.affection-heart.filled {
  color: #ff6b9d;
  transform: scale(1.2);
  filter: drop-shadow(0 0 8px rgba(255, 107, 157, 0.6));
}

/* Heart filling animation */
@keyframes heartFill {
  0% {
    transform: scale(1);
    filter: none;
  }
  50% {
    transform: scale(1.4);
    filter: drop-shadow(0 0 12px rgba(255, 107, 157, 1));
  }
  100% {
    transform: scale(1.1);
    filter: drop-shadow(0 0 6px rgba(255, 107, 157, 0.8));
  }
}

/* Dynamic text fading for "Lyric Mode" */
.lyric-mode {
  animation: lyricFade 8s ease-in-out forwards;
}

@keyframes lyricFade {
  0% { opacity: 1; }
  70% { opacity: 1; }
  100% { opacity: 0.3; }
}

.shadow-slash {
  position: absolute;
  width: 200px;
  height: 3px;
  background: linear-gradient(90deg, transparent, #7c4dff, #9c27b0, transparent);
  box-shadow: 0 0 20px #7c4dff, 0 0 40px #9c27b0;
  animation: slash-move 0.3s ease-out forwards;
  pointer-events: none;
  z-index: 10;
}

@keyframes slash-move {
  0% { transform: translate(-50%, -50%) rotate(45deg) scaleX(0); opacity: 1; }
  50% { transform: translate(-50%, -50%) rotate(45deg) scaleX(1); opacity: 1; }
  100% { transform: translate(-50%, -50%) rotate(45deg) scaleX(1); opacity: 0; }
}

.heart {
  transition: all 0.3s ease;
  filter: grayscale(100%);
  opacity: 0.3;
}

.heart.filled {
  filter: grayscale(0%);
  opacity: 1;
}

@keyframes heartBeat {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

@keyframes float-up {
  0% { 
    transform: translateY(0);
    opacity: 1;
  }
  100% { 
    transform: translateY(-50px);
    opacity: 0;
  }
}

/* Affection button sparkle animation */
@keyframes sparkle {
  0%, 100% { 
    transform: scale(1) rotate(0deg);
    box-shadow: 0 0 5px rgba(255, 182, 193, 0.5);
  }
  25% { 
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 0 15px rgba(255, 182, 193, 0.8), 0 0 25px rgba(255, 105, 180, 0.6);
  }
  50% { 
    transform: scale(1.2) rotate(-5deg);
    box-shadow: 0 0 20px rgba(255, 182, 193, 1), 0 0 30px rgba(255, 105, 180, 0.8), 0 0 40px rgba(255, 20, 147, 0.6);
  }
  75% { 
    transform: scale(1.1) rotate(3deg);
    box-shadow: 0 0 15px rgba(255, 182, 193, 0.8), 0 0 25px rgba(255, 105, 180, 0.6);
  }
}

.sparkle-effect {
  animation: sparkle 2s ease-in-out;
  position: relative;
}

.sparkle-effect::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(45deg, transparent, rgba(255, 182, 193, 0.3), transparent, rgba(255, 105, 180, 0.3), transparent);
  border-radius: inherit;
  animation: sparkle-border 2s ease-in-out;
  z-index: -1;
}

@keyframes sparkle-border {
  0%, 100% { opacity: 0; }
  50% { opacity: 1; }
}

.damage-number {
  position: absolute;
  font-size: 28px;
  font-weight: bold;
  color: #ffeb3b;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
  animation: damage-float 1s ease-out forwards;
  z-index: 10;
  pointer-events: none;
}

@keyframes damage-float {
  0% { transform: translateY(0); opacity: 1; }
  100% { transform: translateY(-50px); opacity: 0; }
}

/* Loading spinner for scene generation */
.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid rgba(255,255,255,0.2);
  border-top-color: #7c4dff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Enhanced chat message animations */
.animate-in {
  animation: slideIn 0.5s ease-out;
}

@keyframes slideIn {
  from { 
    opacity: 0; 
    transform: translateY(20px); 
  } 
  to { 
    opacity: 1; 
    transform: translateY(0); 
  }
}

/* Ken Burns effect for backgrounds */
.ken-burns-1 {
  animation: kenBurns-1 20s ease-in-out infinite alternate;
}

.ken-burns-2 {
  animation: kenBurns-2 20s ease-in-out infinite alternate;
}

@keyframes kenBurns-1 {
  from { transform: scale(1.05) translate(0%, 0%); }
  to { transform: scale(1.2) translate(-4%, 2%); }
}

@keyframes kenBurns-2 {
  from { transform: scale(1.05) translate(0%, 0%); }
  to { transform: scale(1.2) translate(3%, -1%); }
}

@keyframes sparkle {
  0%, 100% { 
    box-shadow: 0 0 20px rgba(255, 192, 203, 0.8), 
                0 0 40px rgba(255, 192, 203, 0.6),
                0 0 60px rgba(255, 192, 203, 0.4);
    transform: scale(1);
  }
  50% { 
    box-shadow: 0 0 30px rgba(255, 192, 203, 1), 
                0 0 50px rgba(255, 192, 203, 0.8),
                0 0 70px rgba(255, 192, 203, 0.6);
    transform: scale(1.1);
  }
}

@keyframes sparkle-twinkle {
  0%, 20%, 40%, 60%, 80%, 100% {
    opacity: 0;
    transform: scale(0.5) rotate(0deg);
  }
  10%, 30%, 50%, 70%, 90% {
    opacity: 1;
    transform: scale(1) rotate(180deg);
  }
}

@keyframes sparkle-orbit {
  0% {
    transform: rotate(0deg) translateX(20px) rotate(0deg);
    opacity: 0;
  }
  10%, 90% {
    opacity: 1;
  }
  100% {
    transform: rotate(360deg) translateX(20px) rotate(-360deg);
    opacity: 0;
  }
}

@keyframes sparkle-burst {
  0% {
    transform: scale(0) rotate(0deg);
    opacity: 0;
  }
  15% {
    transform: scale(1.2) rotate(90deg);
    opacity: 1;
  }
  85% {
    transform: scale(0.8) rotate(270deg);
    opacity: 0.7;
  }
  100% {
    transform: scale(0) rotate(360deg);
    opacity: 0;
  }
}

.sparkle-effect {
  animation: sparkle 1.5s ease-in-out;
}

.sparkle-container {
  position: relative;
  display: inline-block;
}

.sparkle-twinkle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: radial-gradient(circle, #fff 0%, #ffd700 50%, transparent 100%);
  border-radius: 50%;
  animation: sparkle-twinkle 2s infinite;
  pointer-events: none;
}

.sparkle-orbit {
  position: absolute;
  width: 3px;
  height: 3px;
  background: radial-gradient(circle, #fff 0%, #ff69b4 70%, transparent 100%);
  border-radius: 50%;
  animation: sparkle-orbit 3s linear infinite;
  pointer-events: none;
}

.sparkle-burst {
  position: absolute;
  width: 6px;
  height: 6px;
  background: radial-gradient(circle, #fff 0%, #9333ea 30%, #ec4899 70%, transparent 100%);
  border-radius: 50%;
  animation: sparkle-burst 1.5s ease-out infinite;
  pointer-events: none;
}

:root {
  --background: 240 10% 3.9%;
  --foreground: 0 0% 98%;
  --muted: 240 3.7% 15.9%;
  --muted-foreground: 240 5% 64.9%;
  --popover: 240 10% 3.9%;
  --popover-foreground: 0 0% 98%;
  --card: 240 10% 3.9%;
  --card-foreground: 0 0% 98%;
  --border: 240 3.7% 15.9%;
  --input: 240 3.7% 15.9%;
  --primary: 229 84% 67%;
  --primary-foreground: 229 100% 8%;
  --secondary: 240 3.7% 15.9%;
  --secondary-foreground: 0 0% 98%;
  --accent: 240 3.7% 15.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --ring: 240 4.9% 83.9%;
  --radius: 0.5rem;
  
  /* Mystical theme colors */
  --mystical-primary: 229 84% 67%; /* #667eea */
  --mystical-secondary: 274 55% 56%; /* #764ba2 */
  --mystical-dark: 240 30% 11%; /* #1c1c1e */
  --mystical-darker: 240 50% 6%; /* #0f0f1e */
  --space-dark: 240 12% 11%; /* #1c1c1e */
  --space-darker: 240 40% 6%; /* #0f0f1e */
}

.dark {
  --background: 240 10% 3.9%;
  --foreground: 0 0% 98%;
  --muted: 240 3.7% 15.9%;
  --muted-foreground: 240 5% 64.9%;
  --popover: 240 10% 3.9%;
  --popover-foreground: 0 0% 98%;
  --card: 240 10% 3.9%;
  --card-foreground: 0 0% 98%;
  --border: 240 3.7% 15.9%;
  --input: 240 3.7% 15.9%;
  --primary: 229 84% 67%;
  --primary-foreground: 229 100% 8%;
  --secondary: 240 3.7% 15.9%;
  --secondary-foreground: 0 0% 98%;
  --accent: 240 3.7% 15.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --ring: 240 4.9% 83.9%;
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
  }
}

@layer components {
  .mystical-gradient {
    background: linear-gradient(135deg, hsl(var(--mystical-primary) / 0.1) 0%, hsl(var(--mystical-secondary) / 0.1) 100%);
    border: 1px solid hsl(var(--mystical-primary) / 0.3);
  }

  .scene-gradient {
    background: linear-gradient(180deg, hsl(240 46% 14%) 0%, hsl(240 50% 6%) 100%);
  }

  .choice-hover {
    transition: all 0.3s ease;
  }

  .choice-hover:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
    box-shadow: 0 4px 20px hsl(var(--mystical-primary) / 0.2);
  }

  .particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: hsl(var(--mystical-primary));
    border-radius: 50%;
    pointer-events: none;
  }

  .floating-particle {
    animation: float-up 8s infinite linear;
  }

  .glow-pulse {
    animation: glow-pulse 2s ease-in-out infinite alternate;
  }

  .rune-glow {
    animation: rune-glow 3s ease-in-out infinite alternate;
  }
}

@keyframes float-up {
  0% {
    opacity: 0;
    transform: translateY(0px) translateX(0px);
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translateY(-150px) translateX(20px);
  }
}

@keyframes glow-pulse {
  0% {
    filter: drop-shadow(0 0 8px hsl(var(--mystical-primary) / 0.5));
    transform: scale(1);
  }
  100% {
    filter: drop-shadow(0 0 20px hsl(var(--mystical-primary) / 0.8));
    transform: scale(1.1);
  }
}

@keyframes rune-glow {
  0% {
    filter: blur(8px);
    opacity: 0.5;
    transform: scale(1);
  }
  100% {
    filter: blur(12px);
    opacity: 1;
    transform: scale(1.2);
  }
}

@keyframes core-pulse {
  0%, 100% {
    opacity: 0.8;
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(1.1);
  }
}

/* iMessage-style text animations */
@keyframes message-slide-in {
  0% {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes message-slide-out {
  0% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  100% {
    opacity: 0;
    transform: translateY(-30px) scale(0.95);
  }
}

@keyframes message-fade-stay {
  0% {
    opacity: 0;
    transform: translateY(10px);
  }
  8% {
    opacity: 1;
    transform: translateY(0);
  }
  90% {
    opacity: 1;
    transform: translateY(0);
  }
  100% {
    opacity: 0.7;
    transform: translateY(0);
  }
}

/* Text message styles */
.message-entering {
  animation: message-slide-in 0.3s ease-out forwards;
}

.message-staying {
  animation: message-fade-stay 8s ease forwards;
}

.message-exiting {
  animation: message-slide-out 0.5s ease-in forwards;
}

.message-bubble {
  transition: all 0.3s ease;
  will-change: transform, opacity;
}

/* Chat message container improvements */
.chat-message {
  margin-bottom: 12px;
  animation-fill-mode: forwards;
  transform-origin: center bottom;
}

/* Chat bubble frosted effect for text readability */
.chat-message .glassmorphism {
  background: rgba(0, 0, 0, 0.45);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.15);
}

.message-bubble {
  backdrop-filter: blur(8px);
}

/* Speaking glow effects */
.message-speaking {
  animation: speaking-glow 2s ease-in-out infinite;
}

@keyframes speaking-glow {
  0%, 100% {
    box-shadow: 0 0 10px rgba(139, 92, 246, 0.3);
  }
  50% {
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.7), 0 0 30px rgba(139, 92, 246, 0.5);
  }
}

.message-speaking-cha-hae-in {
  animation: speaking-glow-pink 2s ease-in-out infinite;
}

@keyframes speaking-glow-pink {
  0%, 100% {
    box-shadow: 0 0 10px rgba(236, 72, 153, 0.3);
  }
  50% {
    box-shadow: 0 0 20px rgba(236, 72, 153, 0.7), 0 0 30px rgba(236, 72, 153, 0.5);
  }
}

.message-speaking-narrator {
  animation: speaking-glow-purple 2s ease-in-out infinite;
}

@keyframes speaking-glow-purple {
  0%, 100% {
    box-shadow: 0 0 10px rgba(147, 51, 234, 0.3);
  }
  50% {
    box-shadow: 0 0 20px rgba(147, 51, 234, 0.7), 0 0 30px rgba(147, 51, 234, 0.5);
  }
}

/* Responsive Design - Mobile First */
@media (max-width: 640px) {
  .chat-message {
    margin-bottom: 8px;
  }
  
  .chat-message .glassmorphism {
    padding: 12px;
    font-size: 14px;
  }
  
  .choice-button {
    padding: 12px 16px;
    font-size: 14px;
    margin-bottom: 8px;
  }
  
  .game-ui-container {
    padding: 12px;
    bottom: 12px;
  }
}

@media (max-width: 480px) {
  .chat-container {
    padding: 8px;
  }
  
  .chat-message .glassmorphism {
    padding: 10px;
    font-size: 13px;
  }
  
  .choice-button {
    padding: 10px 14px;
    font-size: 13px;
  }
  
  .game-ui-container {
    padding: 8px;
    bottom: 8px;
  }
}

@media (min-width: 1024px) {
  .chat-container {
    max-width: 60%;
    margin: 0 auto;
  }
  
  .choice-container {
    max-width: 50%;
    margin: 0 auto;
  }
}

@media (min-width: 1280px) {
  .chat-container {
    max-width: 50%;
  }
  
  .choice-container {
    max-width: 40%;
  }
}

/* Purchase Confirmation Effects */
@keyframes purchase-popup {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.5);
  }
  20% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.1);
  }
  80% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
}

.purchase-glow {
  animation: purchase-glow-effect 1s ease-out;
  position: relative;
  overflow: visible;
}

@keyframes purchase-glow-effect {
  0% {
    box-shadow: 0 0 0 rgba(34, 197, 94, 0.5);
  }
  50% {
    box-shadow: 0 0 30px rgba(34, 197, 94, 0.8), 0 0 60px rgba(34, 197, 94, 0.4);
  }
  100% {
    box-shadow: 0 0 0 rgba(34, 197, 94, 0.5);
  }
}
